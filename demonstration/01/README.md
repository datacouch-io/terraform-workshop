# Demo #1: The Terraform Magic

Take a look at this directory.  You should see a couple of files aside from this README.

```bash
ls -lah
```

You'll see 2 .tf files:

### provider.tf

This is the file where the provioder configurations are specified. Very often, The provider configuration is specified in the main.tf instead as well.

Inside, you will see the following:

```HCL
terraform {
  required_providers {
    aws = {
      source = "hashicorp/aws"
      version = "4.3.0"
    }
  }
}

provider "aws" {
  region = "eu-west-2"
}
```

### main.tf

Though the name of a terraform config file is mostly arbitrary, this is generally the name ascribed 
to the major configuration file within a Terraform working directory.

Inside, you will see the following:

```HCL
resource "aws_vpc" "demo_vpc" {
  cidr_block = "10.0.0.0/16"

  tags = {
    Name = "tf-example"
  }
}

resource "aws_subnet" "demo_subnet" {
  vpc_id            = aws_vpc.demo_vpc.id
  cidr_block        = "10.0.0.0/24"
  availability_zone = "eu-west-2a"

  tags = {
    Name = "tf-example"
  }
}

resource "aws_network_interface" "demo_eni" {
  subnet_id   = aws_subnet.demo_subnet.id
  private_ips = ["10.0.0.100"]

  tags = {
    Name = "primary_network_interface"
  }
}

data "aws_ami" "amazon" {
  owners = ["amazon"]
  most_recent = true


}
resource "aws_instance" "foo" {
  ami           = data.aws_ami.amazon.id
  instance_type = "t2.micro"

  network_interface {
    network_interface_id = aws_network_interface.demo_eni.id
    device_index         = 0
  }

  credit_specification {
    cpu_credits = "unlimited"
  }
}
```

### variables.tf

Now look into the "variables.tf" file.  You should see this:

```hcl
# Declare a variable so we can use it
variable "student_alias" {
  description = "Your student alias"
}
```

This directory is a very simple example of a terraform project or module.

### Commands

So we have these files that make up our project, now what?  Well, let's try to run some terraform commands against them

```bash
# init is generally the first command you run after writing your config files.  It does 
# a few things but a simple way to thing about init: it initializes the working directory to prepare 
# it to run plans and applies
terraform init


# On running plan command, terraform performs a refresh(unless explicitly disabled) and then 
# determines what actions are necessary to achieve the desired state specified in the configuration files
terraform plan


#The terraform apply command is used to apply the changes required to reach the desired state of the configuration,
# or the predetermined set of actions generated by a terraform plan execution plan

terraform apply
```
